<html>
<head>
<title>Plotscripting Tutorial for the O.H.R.RPG.C.E.</title>
</head>
<body bgcolor="000000" text="f0f0f0" link="00ff00" vlink="009090" alink="d0d000">

<font size="6">PlotScripting</font>
<font size="3">tutorial for beginners</font><br>
Last Updated December 16 1999<br>

<p>
What is plotscripting? From the most simple perspective plotscripting is where the computer takes control of the characters in your RPG, and moves them around, and makes them say stuff. Anyone who has played popular RPGs like Final Fantasy will be familiar with this concept.
</p>
<p>
Plotscripting is actually capable of far more than that, even allowing you to create puzzles, mini-games, and effects in your game, but that sort of thing is not covered in this tutorial. People who want to use the programming-language-like features of plotscripting should read the <a href="plotdictionary.html">Dictionary of PlotScripting Commands</a> and the <a href="hamsterspeak.html">HamsterSpeak Specification</a>
</p>

<hr>

<font size="4">
<a href="#gettingstarted">Getting Started</a><br>
<a href="#createscript">Creating a Script File</a><br>
<a href="#firstscript">Your First Script</a><br>
<a href="#compilescript">Compiling Your Script</a><br>
<a href="#importscript">Importing Your Script into CUSTOM.EXE</a><br>
<a href="#callscript">Calling Your Script</a><br>
<a href="#runscript">Running Your Script</a><br>
<a href="#walkaround">Making the Hero Walk Around</a><br>
<a href="#suspendplayer">Stopping Normal Controls</a><br>
<a href="#npcscript">Starting a Script with an NPC</a><br>
<a href="#cleanup">Making your Script Easyer to Read</a><br>
<a href="#arguments">Giving a Script Arguments</a><br>
<a href="#learnmore">Learning More</a><br>
</font>

<hr>

<a name="gettingstarted"></a>
<font size="4" color="f06060">Getting Started</font><br>
<p>
First of all, you need to make sure that you have the latest version of the OHRRPGCE from <a href="http://HamsterRepublic.com/html/ohrrpgce.html">http://HamsterRepublic.com/html/ohrrpgce.html</a>. Versions older than November X 1999 do not have plotscripting.
</p>
<p>
Okay. This tutorial will walk you through writing a script, compiling it with HSPEAK.EXE, importing it into CUSTOM.EXE, telling your RPG file when and where to run it, and testing the finished script in GAME.EXE. The examples will use PSTUTOR.RPG (included in CUSTOM.ZIP) but if you already have an RPG file in progress, you may want to adapt these instructions for your own game. These examples will assume that you have installed the O.H.R.RPG.C.E in C:\OHRRPGCE\ if you put it somewhere else, just substitute your directory in the examples.
</p>
<p>
To make sure you have the OHRRPGCE installed and running okay, run GAME.EXE and pick PSTUTOR.RPG from the list. Press a key to get past the title screen, and you should see a silly looking little robot standing on a small platform in space. This is the file that you will be adding plotscripts to as you follow this tutorial. Press ESC and quit.
</p>

<hr>

<a name="createscript"></a>
<font size="4" color="f06060">Creating a Script File</font><br>
<p>
A script is a simple text file, and you can write it in any text editor. If you dont already have a favorite text editor, I suggest that Windows users use <font color="yellow">notepad.exe</font> and DOS users use <font color="yellow">edit.com</font>. If you write your script in a word processor like <font color="yellow">Microsoft Word</font> or <font color="yellow">Corel WordPerfect</font> make sure that you save as plain ASCII text (DOS text)
</p>
<p>
Open a new text file in your text editor, and save it as C:\OHRRPGCE\PSTUTOR.HSS<br>
The .HSS extension stands for <b>H</b>amster<b>S</b>peak <b>Script</b>. (this is just suggested. you can use whatever extension you want, even .TXT)
</p>
<p>
At the top of your script, type the following two lines:

<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi
</pre></font></b></td></tr></table><br>
plotscr.hsd had the definitions of all of the Plotscripting commands.<br>
pstutor.hsi contains information about PSTUTOR.RPG. This tutorial will explain later how to create an HSI file (<b>H</b>amster<b>S</b>peak <b>I</b>nclude)
</p>

<hr>

<a name="firstscript"></a>
<font size="4" color="f06060">Your First Script</font><br>
<p>
Okay, now it is time to write a script. the first step is to define the script.
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)
</pre></font></b></td></tr></table><br>
This tells the compiler that your script number 1 is going to be named "Hello World" and that it doesnt need any arguments. (arguments are only useful for advanced users, and are not discussed in this tutorial. See the <a href="hamsterspeak.html">HamsterSpeak Specification</a> if you want to know more)
</p>
<p>
now, you write the body of the script.
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)

script, Hello World, begin
show text box (1)
end
</pre></font></b></td></tr></table><br>
this script only has one command, "show text box". When the script is run, it will display the text box numbered in the parenthesis (1) just as if you had talked to an NPC. (Text Box 1 in PSTUTOR.RPG has already been made for you, and all it says is "Hello world!")
</p>
<p>
Save your script
</p>

<hr>

<a name="compilescript"></a>
<font size="4" color="f06060">Compiling Your Script</font><br>
<p>
Not it is time to compile your plotscript. This takes script you just wrote, and converts it into a binary file that can be used by the OHRRPGCE.
</p>
<p>
If you are using DOS, or a DOS prompt in windows, go to C:\OHRRPGCE and type:<br>
<tt>HSPEAK PSTUTOR.HSS</tt>
</p>
<p>
If you are one of them point-and-click people:<ul>
 <li>use <font color="yellow">Windows Explorer</font> or <font color="yellow">My Computer</font> to open the OHRRPGCE folder on drive C
 <li>Double-click on PSTUTOR.HSS
 <li>The "Open As" window will appear, asking you what application you want to use for .HSS files
 <li>Click "other" and type in the path to HSPEAK.EXE (probably C:\OHRRPGCE\HSPEAK.EXE)
 <li>Click "OK", make sure "Always use this program" is checked, and click "OK" again
 <li>Next time, all you will have to do is double click on the HSS file
 </ul>
</p>
<p>
Now, you should have a file called PSTUTOR.HS. This is the compiled plotscript.
</p>

<hr>

<a name="importscript"></a>
<font size="4" color="f06060">Importing Your Script into CUSTOM.EXE</font><br>
<p>
Now it is time to import your script into your RPG.
</p>
<ul>
 <li>Run CUSTOM.EXE and open PSTUTOR.RPG
 <li>From the main menu, choose <font color="yellow">Script Management</font>
 <li>Choose <font color="yellow">Import Compiled Plotscripts</font>
 <li>Find PSTUTOR.HS in the file browser
 <li>When you choose PSTUTOR.HS, you will see the name of the script, "helloworld", and it will say "1 script imported sucessfully"
 <li>Dont quit CUSTOM.EXE yet, we need to make something call the script
</ul>

<hr>

<a name="callscript"></a>
<font size="4" color="f06060">Calling Your Script</font><br>
<p>
So when does your script get run?<br>
There are many ways to call a script in your RPG. You can have a script run automatically when you start a new game, when you enter a map, when you talk to an NPC, when you use an item, when you die in battle, when you use an Inn, and possibly some other places that I havent implemented yet or cant remeber :)
</p>
<p>
for the moment, we will use the autorun script that is run when you start a new game
<ul>
 <li>From the main menu in CUSTOM.EXE, pick <font color="yellow">Edit General Game Data</font>
 <li>Pick <font color="yellow">Special Plotscripts</font>
 <li>For <font color="yellow">new game script</font> choose <font color="yellow">helloworld</font>
 <li>Exit, and save your changes to PSTUTOR.RPG
</ul>
</p>

<hr>

<a name="runscript"></a>
<font size="4" color="f06060">Running Your Script</font><br>
<ul>
<li>Run GAME.EXE
<li>Open PSTUTOR.RPG
<li>Press any key when prompted
<li>As soon as you start, the script will run, and you will immediately see the "Hello World" text box
</ul>
<p>
Congratulations! You just ran your first plotscript!<br>
"But that is so boring!" you say. Well, read on. Lets make your script more interesting
</p>

<hr>

<a name="walkaround"></a>
<font size="4" color="f06060">Making the Hero Walk Around</font><br>
<p>
Showing text boxes is all well and good, but you can do that without plotscripting. Now lets try something that you cant do without plotscripting; making your hero move in a predefined pattern.
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)

script, Hello World, begin
show text box (1)
wait for text box
walk hero (me,north,3)
wait for hero (me)
set hero direction (me,south)
end
</pre></font></b></td></tr></table><br>
Add these four new commands to your "Hello World" script. This is what the commands do:
<table border="1"><tr><td><ul>
 <li><font color="yellow">show text box (1)</font> displays a text box, same as before
 <li><font color="yellow">wait for text box</font> waits for you to press a key and get rid of the text box
 <li><font color="yellow">walk hero (me,north,3)</font> makes your hero walk north for three spaces. <font color="yellow">me</font> is a special name that refers to your main hero
 <li><font color="yellow">wait for hero (me)</font> waits for the main hero (me) to finish walking
 <li><font color="yellow">set hero direction (me,south)</font> makes the main hero face south
</ul></td></tr></table>
</p>
<ul>
 <li>Save the changes to your script.
 <li>Recompile your script by double-clicking on PSTUTOR.HSS or typing <tt>HSPEAK&nbsp;PSTUTOR.HSS</tt> at a dos prompt.
 <li>This time, HSPEAK.EXE will ask you if you want to overwrite the existing PSTUTOR.HS file. Press Y for yes.
 <li>Run CUSTOM.EXE and open PSTUTOR.RPG
 <li>From the main menu, choose <font color="yellow">Script Management</font>
 <li>Choose <font color="yellow">Import Compiled Plotscripts</font>
 <li>Choose PSTUTOR.HS in the file browser
 <li>Exit, and save your changes to PSTUTOR.RPG
 <li>Run GAME.EXE and open PSTUTOR.RPG
 <li>After you start, the "Hello World" text box will pop up, and after you press a key, the hero will walk north, and then turn to face you.
</ul>

<hr>

<a name="suspendplayer"></a>
<font size="4" color="f06060">Stopping Normal Controls</font><br>
<p>
Try running your script again, but this time, press left or right as the robot moves. As you can see, the player can interfere with the plotscript. How do we prevent this?
</p>
<p>
Go back to your plotscript, and add the following commands:
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)

script, Hello World, begin
suspend player
show text box (1)
wait for text box
walk hero (me,north,3)
wait for hero (me)
set hero direction (me,south)
resume player
end
</pre></font></b></td></tr></table><br>
the <font color="yellow">suspend player</font> command at the begining prevents the player from moving the hero around or bringign up the menu. It effectively blocks all of the players controls (except that it still allows them to advance text boxes). The <font color="yellow">resume player</font> command at the end of your script gives control of the hero back to the player. Almost every script you write will start with suspend player, and end with resume player
</p>
<p>
Now recompile your script, reimport it, and test it again. This time, you will not be able to interfere when the robot walks three spaces north.
</p>

<hr>

<a name="npcscript"></a>
<font size="4" color="f06060">Starting a Script with an NPC</font><br>
<p>
Probably the most common way that you will want to start your scripts is by talking to NPCs. Lets add a new script, and show you how to start it with an NPC
</p>
<p>
Define a new script called "Robot Dance"
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)
define script (2,Robot Dance,none)

script, Hello World, begin
suspend player
show text box (1)
wait for text box
walk hero (me,north,3)
wait for hero (me)
set hero direction (me,south)
resume player
end
</pre></font></b></td></tr></table><br>
</p>
<p>
Now, lets write the script.
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)
define script (2,Robot Dance,none)

script, Hello World, begin
suspend player
show text box (1)
wait for text box
walk hero (me,north,3)
wait for hero (me)
set hero direction (me,south)
resume player
end

script, Robot Dance, begin
suspend player
walk NPC (0,west,1)
wait for NPC (0)
walk NPC (0,east,2)
wait for NPC (0)
walk NPC (0,west,1)
wait for NPC (0)
set NPC direction (0,north)
wait (4)
set NPC direction (0,east)
wait (4)
set NPC direction (0,south)
resume player
end
</pre></font></b></td></tr></table><br>
Look at the commands this script uses. NPC zero (the first NPC) will walk left, then right, then back to the center, and then spin in a circle. The <font color="yellow">wait (4)</font> commands are to make sure that he does not spin so fast that you cant see it happen.
</p>
<p>
Recompile the script, and import it into PSTUTOR.RPG. This time, when you import the .HS file, CUSTOM.EXE will tell you that it successfully imported 2 scripts, and it will show you the names "helloworld" and "robotdance"
</p>
<ul>
 <li>Now, go back to the main menu
 <li>choose <font color="yellow">Edit Map Data</font>
 <li>choose <font color="yellow">Map 00</font>
 <li>Choose <font color="yellow">Edit NPCs</font>
 <li>I have already created NPC 0 for you. He is the one with green feet. Choose him, and edit his properties
 <li>Notice that he has a <font color="yellow">walking speed</font> of 4 even though his <font color="yellow">movement type</font> is "stand still". This is because the <font color="yellow">Walk NPC</font> command will not work on an NPC with 0 speed
 <li>Change his <font color="yellow">Run Script:</font> property from [none] to "robotdance"
 <li>Press ESC twice to get out of the NPC editor
 <li>Choose <font color="yellow">Place NPCs</font> and place the green-footed robot somewhere on the platform
 <li>Exit, and save your changes to PSTUTOR.RPG
 <li>Run GAME.EXE, open PSTUTOR.RPG, and talk to the NPC
 <li>The green footed robot should do a dance for you when you talk to him
</ul>

<hr>

<a name="cleanup"></a>
<font size="4" color="f06060">Making your Script Easyer to Read</font><br>
<p>
as a script gets bigger, it can get hard to read. To make things easyer on yourself, you can add comments, indentation, and spacing to make your script look cleaner.
</p>
<p>
comments are notes to yourself that remind you how your script works. Comments are ignored by the compiler. To make a comment, just start a line with a #
</p>
<p>
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
# This is my practice script. It is for use with PSTUTOR.RPG

include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)
define script (2,Robot Dance,none)

#---------------------------------------------
#this script makes the robot say "Hello World"
#and then walk three spaces north

script, Hello World, begin
  suspend player
  show text box       (1)
  wait for text box
  walk hero           (me,north,3)
  wait for hero       (me)
  set hero direction  (me,south)
  resume player
end

#---------------------------------------------
#This script makes an NPC do a dance

script, Robot Dance, begin
  suspend player
  walk NPC            (0,west,1)
  wait for NPC        (0)
  walk NPC            (0,east,2)
  wait for NPC        (0)
  walk NPC            (0,west,1)
  wait for NPC        (0)
  set NPC direction   (0,north)
  wait                (4)
  set NPC direction   (0,east)
  wait                (4)
  set NPC direction   (0,south)
  resume player
end
</pre></font></b></td></tr></table><br>
</p>
<p>
There. now isnt that easyer to look at?
</p>

<hr>

<a name="arguments"></a>
<font size="4" color="f06060">Giving a Script Arguments</font><br>

<p>
Arguments are a way of passing extra information to a script. I know its a silly name, but its a programming thing, so what do you expect? :)
</p>

<p>
What if you want to be able to make several different NPCs do the NPC dance? The way we have the Robot Dance written right now, the script only works on NPC number zero. What if we want NPC 1, 2 and 3 to do the very same dance when you talk to them? Do we have to make three copies of the script and give them each new ID numbers and names? Nope. That would be way too much work. What we want to do is give the Robot Dance script an argument.
</p>

<p>
<br><table border=1><tr><td bgcolor="f0f0f0"><img src="/img/spacer.gif" width="580" height="1"><br><b><font color="000000"><pre>
# This is my practice script. It is for use with PSTUTOR.RPG

include, plotscr.hsd
include, pstutor.hsi

define script (1,Hello World,none)
define script (2,Robot Dance,1,0)
# the Robot Dance has 1 argument that defaults to 0 if it is left out

#---------------------------------------------
#this script makes the robot say "Hello World"
#and then walk three spaces north

script, Hello World, begin
  suspend player
  show text box       (1)
  wait for text box
  walk hero           (me,north,3)
  wait for hero       (me)
  set hero direction  (me,south)
  resume player
end

#---------------------------------------------
#This script makes an NPC do a dance

script, Robot Dance, who, begin
# the name of the argument is "who"
  suspend player
  walk NPC            (who,west,1)
  wait for NPC        (who)
  walk NPC            (who,east,2)
  wait for NPC        (who)
  walk NPC            (who,west,1)
  wait for NPC        (who)
  set NPC direction   (who,north)
  wait                (4)
  set NPC direction   (who,east)
  wait                (4)
  set NPC direction   (who,south)
  resume player
end
</pre></font></b></td></tr></table><br>
</p>

<ul>
 <li>Recompile your script, and reimport it into CUSTOM.EXE
 <li>Go into the map editor and pick Map 00
 <li>Go into the NPC editor, and look at the green-footed robot
 <li>Right Below the name of the script that he runs, you will see a number for the <font color="yellow">Script Argument</font>. Whatever value you put there will be used as the <font color="yellow">who</font> argument in the script.
 <li>The green-footed robot should use 0 as his argument because he is NPC number 0
 <li>Edit the second NPC, number 1. Give him the Robot Dance script, and make his argument 1
 <li>Put the new NPC on the map
 <li>Exit CUSTOM.EXE and save
 <li>Load PSTUROR.RPG in GAME.EXE and try out both NPCs. Even though they both use the exact same script, the argument allows that one script to do two slightly different things. 
</ul>

<hr>

<a name="learnmore"></a>
<font size="4" color="f06060">Learning More</font><br>
<p>
I hope this is enough to get you started this tutorial will be expanding in the future. Untill then, check out the <a href="plotdictionary.html">Dictionary of PlotScripting Commands</a>
</p>

</body>
</html>
